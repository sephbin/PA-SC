<!DOCTYPE html>
<html>
<head>
	<title></title>
	<script src="https://code.jquery.com/jquery-3.4.1.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
	<script src="https://cdn.jsdelivr.net/npm/handsontable/dist/handsontable.full.min.js" crossorigin="anonymous"></script>
	<link type="text/css" rel="stylesheet" href="https://cdn.jsdelivr.net/npm/handsontable/dist/handsontable.full.min.css">
	<style>
		td {
			background-color: none !important;
			background: none !important;
		}
		tr:nth-child(even) {background: rgba(0,0,0,0.1);}
	</style>
</head>
<body>
<div style="width:100%" id="example"></div>
</body>
<script type="text/javascript">
	var data = [
  
  {"id":1, "name":{"first":"Andrew", "last":"Butler"}, "address":"155 Clarence St."},
  {"id":1, "name":{"first":"Andrew", "last":"Butler"}, "address":"155 Clarence St."},
  {"id":1, "name":{"first":"Andrew", "last":"Butler"}, "address":"155 Clarence St."},
  {"id":1, "name":{"first":"Andrew", "last":"Butler"}, "address":"155 Clarence St."},
  {"id":1, "name":{"first":"Andrew", "last":"Butler"}, "address":"155 Clarence St."},
  {"id":1, "name":{"first":"Andrew", "last":"Butler"}, "address":"155 Clarence St."},
];
// var rowHeaders = ['2017', '2018', '2019']
var colHeaders= ['ID',   'First Name', 'Last Name', 'Address']
var columns = [
    {data: 'id'},
    {data: 'name.first'},
    {data: 'name.last', type: 'dropdown', source: ['yellow', 'red', 'orange', 'green', 'blue', 'gray', 'black', 'white', 5]},
    {data: 'address'}
  ]



var container = document.getElementById('example');
var hot = new Handsontable(container, {
  licenseKey: 'non-commercial-and-evaluation',
  data: data,
  dataSchema: {id: null, name:{last: null, first: null}, address: null},
  // rowHeaders: rowHeaders,
  colHeaders: colHeaders,
  width: '100%',
  stretchH: 'all',
  columns: columns,
  // colWidths: [45, 100, 160, 160, 80, 80, 80],
  manualColumnResize: true,
  manualColumnMove: true,
  // fixedColumnsLeft: 1,
  // contextMenu: ['row_above', 'row_below', 'remove_row'],
  contextMenu: true,
  manualColumnFreeze: true,
  // dropdownMenu: true,
  // colHeaders: true,
  // filters: true,
  // dropdownMenu: true,
  // afterChange: (changes) => {
  //   changes.forEach(([y, x, oldValue, newValue]) => {
  //     console.log(x,y,oldValue,newValue);
  //     console.log(rowHeaders[y], colHeaders[x]);
  //   });
  // }
  afterChange: function (change, source) {
    // if (source === 'loadData') {
      // return; //don't save this change
    // }
    // if (!autosave.checked) {
      // return;
    // }
    // clearTimeout(autosaveNotification);
    console.log(change);
    console.log(source);
    // ajax('scripts/json/save.json', 'GET', JSON.stringify({data: change}), function (data) {
    //   exampleConsole.innerText  = 'Autosaved (' + change.length + ' ' + 'cell' + (change.length > 1 ? 's' : '') + ')';
    //   autosaveNotification = setTimeout(function() {
    //     exampleConsole.innerText ='Changes will be autosaved';
    //   }, 1000);
    // });
  }

});
</script>
</html>